# Database Schema

This directory contains the SQL script (`schema.sql`) to create the database schema for an Airbnb-like application using PostgreSQL.

## Schema Overview
- **User**: Stores user information (guests, hosts, admins) with a unique email and role constraint.
- **Property**: Stores property details, linked to a host (User).
- **Booking**: Stores booking details, linked to a user and property, with date and status constraints.
- **Payment**: Stores payment details, linked to a booking, with a one-to-one relationship.
- **Review**: Stores reviews for properties, linked to a user and property, with a rating constraint.
- **Message**: Stores messages between users for communication.

## Constraints
- **Primary Keys**: UUIDs generated by `gen_random_uuid()` for unique identification.
- **Foreign Keys**: Enforce referential integrity with `ON DELETE CASCADE`.
- **Unique Constraints**: `User.email` and `Payment.booking_id` are unique; `Booking` has a unique constraint on `(property_id, start_date, end_date)` to prevent overlapping bookings.
- **Check Constraints**: 
  - `User.role` limited to 'guest', 'host', 'admin'.
  - `Property.price_per_night` and `Payment.amount` must be non-negative.
  - `Booking.total_price` must be non-negative, and `end_date` must be after `start_date`.
  - `Review.rating` must be between 1 and 5.
  - `Payment.payment_method` limited to 'credit_card', 'paypal', 'bank_transfer'.

## Indexes
- Indexes on frequently queried columns:
  - `User.email` for login queries.
  - `Property.location` for location-based searches.
  - `Booking.user_id` and `Booking.property_id` for user and property queries.
  - `Payment.booking_id` for payment lookups.
  - `Review.property_id` and `Review.user_id` for review queries.
  - `Message.sender_id` and `Message.recipient_id` for message queries.

## Usage
1. Ensure PostgreSQL is installed.
2. Run `schema.sql` in your PostgreSQL database to create the tables and indexes:
   ```bash
   psql -U <username> -d <database> -f schema.sql